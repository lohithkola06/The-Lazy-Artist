---
globs: src/train.py,src/eval.py
alwaysApply: false
---
Applies to `src/train.py` and `src/eval.py`.

- Always read hyperparams from YAML config.
- Always set seed at program start.
- Always write outputs to `runs/<run_name>_<timestamp>/`:
  - `config.yaml` copy of the config used
  - `train_log.jsonl` (one record per epoch)
  - `checkpoints/best.pt` (and optionally last.pt)
  - `figures/` for saved plots (e.g., confusion matrix)
- Evaluation must support `split=test_hard` and save confusion matrix PNG.
- Keep device handling consistent: cpu/cuda/auto.
